---
menu: Doc API
name: Methods
route: /doc/methods/
---

import { Playground } from 'docz';
import { createElement, useState } from 'react';
import rehype2react from 'rehype-react';
import unifiedDoc from 'unified-doc';

import { Button, FlexLayout, TextInput } from '~/ui';

export const doc = unifiedDoc({
  compiler: [rehype2react, { createElement }],
  content: '# Heading 1\n> some blockquote content with **strong content**',
  filename: 'doc.md',
  searchOptions: { snippetOffsetPadding: 5 },
});

# Methods

This section goes over `doc` methods with interactive code playgrounds.  All examples assume a `doc` instance initialized with the following options:

```js
const doc = unifiedDoc({
  compiler: [rehype2react, { createElement }],
  content: '# Heading 1\n> some blockquote content with **strong content**',
  filename: 'doc.md',
  searchOptions: { snippetOffsetPadding: 5 },
});
```

## `compile()`

```ts
function compile(): VFile;
```

Returns compiled output results that is stored on a [`vfile`][vfile].  Renderers can use the compiled results to render the document.  Compiled results are defined and configured by assigning a specific `compiler` to the `doc`.

<Playground>
  <div>
    {doc.compile().result}
  </div>
</Playground>

## `file()`

```ts
function file(extension?: string): FileData;

interface FileData {
  content: string;
  extension: string;
  name: string;
  stem: string;
  type: string;
}
```

Returns file data for supported extensions (e.g. `.html`, `.txt`, `.uni`).  If an extension is not provided, the source file is returned.

### Source file
<Playground>
  <pre>{JSON.stringify(doc.file(), null, 2)}</pre>
</Playground>

### `.html` file
<Playground>
  <pre>{JSON.stringify(doc.file('.html'), null, 2)}</pre>
</Playground>

### `.txt` file
<Playground>
  <pre>{JSON.stringify(doc.file('.txt'), null, 2)}</pre>
</Playground>

### `.uni` file
<Playground>
  <pre>{JSON.stringify(doc.file('.uni'), null, 2)}</pre>
</Playground>

## `parse()`

```ts
function parse(): Hast;
```

Returns the [`hast`][hast] representation of the tree.  The tree is useful for transformations with `hast` utilities.

<Playground>
  <pre>{JSON.stringify(doc.parse(), null, 2)}</pre>
</Playground>

## `search()`

```ts
function search(
  query: string,
  options?: Record<string, any>,
): SearchResultSnippet[];

interface SearchResultSnippet extends SearchResult {
  snippet: [string, string, string];
}

interface SearchResult {
  [key]: string;
  start: number;
  end: number;
  value: string;
}
```
Searches on the `textContent` of a `doc` when a `query` string and configurable `options` is provided.  Returns `SearchResultSnippet`.  This method supports a simple and robust way to search on a `doc` irregardless of its underlying `mimeType`. Custom `searchAlgorithm` with the same unified interface can be easily integrated.

The default `searchAlgorithm` used by the `doc` is [`unified-doc-search-micromatch`][unified-doc-search-micromatch], which implements convenient wildcard/bash matching features via the [`micromatch`][micromatch] package.

<Playground>
  {() => {
    const [query, setQuery] = useState('');
    const [results, setResults] = useState([]);
    function search(value) {
      const results = doc.search(value);
      setQuery(value);
      setResults(results);
    }
    function clear() {
      setQuery('');
      setResults([]);
    }
    return (
      <FlexLayout flexDirection="column" space={2}>
        {doc.compile().result}
        <TextInput
          id="search"
          label="Search"
          placeholder="try 'content', 'some*content'"
          value={query}
          onChange={search}
        />
        {results.length > 0 && (
          <Button variant="secondary" onClick={clear}>
            Clear
          </Button>
        )}
        {results.map((result, i) => {
          const [left, matched, right] = result.snippet;
          return (
            <div key={i.toString()}>
              {left}
              <strong>{matched}</strong>
              {right}
            </div>
          );
        })}
      </FlexLayout>
    )
  }}
</Playground>

## `textContent()`

```ts
function textContent(): string;
```

The `textContent` of a `doc` is obtained by extracting values of all text nodes in the `hast` representation of the source `content`.  The `textContent` is free of markup and metadata, and supports many important `doc` features (annotations and searching)

<Playground>
  <pre>{doc.textContent()}</pre>
</Playground>

<!-- Links -->
[hast]: https://github.com/syntax-tree/hast
[micromatch]: https://github.com/micromatch/micromatch
[vfile]: https://github.com/vfile/vfile
[unified-doc-search-micromatch]: https://github.com/unified-doc/unified-doc/tree/master/packages/unified-doc-search-micromatch
